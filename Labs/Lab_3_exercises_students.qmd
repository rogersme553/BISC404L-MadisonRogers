# Exercise 0: Appropriately set-up your environment (clear environment, load packages, set working directory if needed, etc.)

```{r setup, include=FALSE}

rm(list = ls())

library(ggplot2)
library(dplyr)

```

# Introduction

In this lab, we will delve deeper into population dynamics, exploring both density-independent and density-dependent growth, as well as interspecific interactions. You will use R to simulate these ecological processes and interpret the results of your simulations.

# Exercise 1:

Load the `tribbles.rds` dataset provided.

```{r}

tribbles <- readRDS("tribbles.rds")

```

::: callout-tip
## \`.Rds\` and \`.Rda\` files in R

`.rds` and `.rda` (or `.Rdata`) files are used to store data natively in R.

The main advantage of `.rda` files is that they can contain a variety of data in a single file (objects, plots, functions, packages, etc.), however when loading a `.rda` file you run the risk of over-writing existing objects, plots, etc. with the same name.

`.rds` files can only contain a single data structure. A benefit of this file type is that loading a `.rds` file will not overwrite data structures with the same name.
:::

### Inspect (using `head()`, `summary()`, `str()`, etc.) and describe the dataset (*hint: what do you need to clean?)*:

```{r}

head(tribbles)

```

```{r}


```

```{r}
summary(tribbles)
str(tribbles)

```

```{=plaintext}
```
### Clean the dataset based on the cleaning we performed in the previous homework assignment

```{r}
# Clean the data

tribbles_clean <- tribbles %>%
  select(Days, Count) %>%
  filter(!is.na(Days), !is.na(Count)) %>%
  arrange(Days)

head(tribbles_clean)


```

### **Step 1: Visualizing Real Data**

Write an R script to plot the population size of tribbles over **5 days** using `ggplot2` for plotting and `dplyr` for data wrangling. Plot using the `geom_line()` function.

```{r}

# Filter the data


# Plot the filtered data. Hint, use xlim(c(1, 5)) to set limits for the x-axis to only show up to day 5. You may need to use ylim(...) as well.

# Filter the data
tribbles_5 <- tribbles_clean %>%
  filter(Days <= 5)

# Plot the filtered data
ggplot(tribbles_5, aes(x = Days, y = Count)) +
  geom_line() +
  xlim(c(1, 5))
```

### Q1: What general trend do you observe in the growth of the tribble population over this period? Does the population appear to be increasing, decreasing, or remaining stable?

```{=plaintext}
The tribble population is increasing rapidly over the five days, with growth accelerating each day rather than remaining constant or stable.
```
### Q2: Does population growth appear to be discrete or continuous? Why?

```{=plaintext}
The growth is discrete because population size is recorded at whole day intervals and changes in stepwise jumps between days.
```
### Q3: Does population growth appear to be density-independent? Why or why not? Which equation, if any, do you think might best fit the trend?

```{=plaintext}
The growth appears independent of density over this period because there is no sign of slowing as population size increases. A discrete exponential growth model using lambda best fits this trend.
```
### Q4: If you think it may be a density-dependent trend, what would you estimate is the carrying capacity of the tribble population?

```{=plaintext}
There is no clear evidence of a carrying capacity within the first five days, this is because the population does not level off/plateau or slow down.
```
### Q5: What are some biological, ecological, or stoichastic explanations that could explain the observed trend?

```{=plaintext}
This pattern could be caused by high reproduction rates, abundant resources, and a lack of predators, disease, or competition limiting the population.
```
### Q6: What might be some expected consequences of this trend for the tribble population for the people living on the ship?

```{=plaintext}
If this trend continues, the population could quickly overwhelm the ship’s space and resources, causing overcrowding and depletion of resources.
```
### **Step 2: Modeling Population Growth**

Now we are going to try to model population growth based on the curve you see from your data. If we accept these models, they will allow us to make generalizations and longer term predictions.

1.  Use **dplyr** to extract the **initial population size** $N_{0}$ (*hint, remember `pull()` from the previous assignment*) and **growth rate** $\lambda$. Think about the situations where you would need to use $r$ versus $\lambda$
2.  We assume the per capita growth rate $\lambda$ can be estimated as the ratio between population sizes. In our case, use $\frac{N_{0 + 1}}{N_{0}}$ to estimate $\lambda$.
3.  If you think you need to include $K$, just set $K$ equal to the largest population number within your current timespan.

```{r}
# Extract initial population size (N0). Hint: remember `pull()` from the previous lab assignment
N0 <- tribbles_5 %>%
  filter(Days == 1) %>%
  pull(Count)

# Extract consecutive population size (day 2)
N1 <- tribbles_5 %>%
  filter(Days == 2) %>%
  pull(Count)

# Calculate Lambda
lambda <- N1 / N0

# Calculate r if necessary
r <- log(lambda)

# Print estimated values
N0
N1
lambda
r

```

Like we did in lab, use `sapply()` to calculate when the tribble population size for each day until the population exceeds **111,537 tribbles** based on our current assumptions

\- If you think density-independent, you can use lambda directly in your equation.

\- If you think logistic growth, remember from lab how to convert lambda to r. We will assume K is equal to the largest population number within the given time span.

\- Be sure to choose the function inside of `sapply()` intentionally, either the exponential or logistic equation from the lab handout.

```{r}
# Set the appropriate t
t <- 0:20

# Use sapply() to model population sizes (discrete exponential growth)
Nt <- sapply(t, function(tt) {
  N0 * (lambda ^ tt)
})

# Find the first day the population exceeds 111,537
t[which(Nt > 111537)[1]]

```

Plot your results like we did in lab:

```{r}

# Convert to dataframe
model_df <- data.frame(
  Day = t,
  Population = Nt
)

# Plot
ggplot(model_df, aes(x = Day, y = Population)) +
  geom_line()


```

### Q: What does this plot imply about the population growth of tribbles on the ship?

```{=plaintext}
The plot implies extremely rapid, exponential population growth, where the tribble population increases slowly at first and then explodes to very large numbers in a short time, quickly exceeding any reasonable limits.
```
### Q: Does the shape of this model match with your plot of the real data above? Do you think it is an accurate model of our system?

```{=plaintext}
The shape matches the real data over the short time span because both show rapidly accelerating growth. However, this model is likely unrealistic long-term because it does not include any limiting factors such as resource availability or space, so it probably overestimates future population size.
```

------------------------------------------------------------------------

# Exercise 2:

### **Step 1: Visualizing Real Data**

Now plot over 8 days and answer the questions below based on this plot.

```{r}

# Filter the data
tribbles_8 <- tribbles_clean %>%
  filter(Days <= 8)

# Plot the filtered data
ggplot(tribbles_8, aes(x = Days, y = Count)) +
  geom_line() +
  xlim(c(1, 8))

```

### Q1: What general trend do you observe in the growth of the tribble population over this period? Does the population appear to be increasing, decreasing, or remaining stable?

```{=plaintext}
The population increases rapidly at first and then begins to slow and level off by days 7–8, indicating that growth is no longer accelerating.
```
### Q2: Does population growth appear to be discrete or continuous? Why?

```{=plaintext}
The growth is discrete because the population is measured at whole day intervals and changes in stepwise jumps between days.
```
### Q3: Does population growth appear to be density-independent? Why or why not? Which equation, if any, do you think might best fit the trend?

```{=plaintext}
The growth appears dependent of density because the rate of increase slows as the population becomes larger. A logistic growth model best fits this trend.
```
### Q4: If you think it may be a density-dependent trend, what would you estimate is the carrying capacity of the tribble population?

```{=plaintext}
The carrying capacity appears to be around 4,000 - 4,500 tribbles, where the population begins to level off/plateau.
```
### Q5: What are some biological, ecological, or stoichastic explanations that could explain the observed trend?

```{=plaintext}
This trend could be explained by limited space or food, increased competition, or waste buildup as the population grows.
```
### Q6: What might be some expected consequences of this trend for the tribble population for the people living on the ship?

```{=plaintext}
As the population approaches carrying capacity, slowing of growth, but the ship will still face overcrowding and strain on resources.
```
### **Step 2: Modeling Population Growth**

Now we are going to try to model population growth based on the curve you see from your data. If we accept these models, they will allow us to make generalizations and longer term predictions.

1.  Use **dplyr** to extract the **initial population size** $N_{0}$ (*hint, remember `pull()` from the previous assignment*) and **growth rate** $\lambda$. Think about the situations where you would need to use $r$ versus $\lambda$
2.  We assume the per capita growth rate $\lambda$ can be estimated as the ratio between population sizes. In our case, use $\frac{N_{0 + 1}}{N_{0}}$ to estimate $\lambda$.
3.  If you think you need to include $K$, just set $K$ equal to the largest population number within your current timespan.

```{r}
# Extract initial population size (N0)
N0_8 <- tribbles_8 %>%
  filter(Days == 1) %>%
  pull(Count)

# Extract consecutive population size (day 2)
N1_8 <- tribbles_8 %>%
  filter(Days == 2) %>%
  pull(Count)

# Calculate lambda
lambda_8 <- N1_8 / N0_8

# Calculate r only if necessary (for logistic growth)
r_8 <- log(lambda_8)

# Set carrying capacity K as the largest population in this time span
K_8 <- max(tribbles_8$Count)

# Print estimated values
N0_8
N1_8
lambda_8
r_8
K_8



```

Like we did in lab, use `sapply()` to calculate when the tribble population size for each day until the population exceeds **111,537 tribbles** based on our current assumptions

\- If you think density-independent, you can use lambda directly in your equation.

\- If you think logistic growth, remember from lab how to convert lambda to r. We will assume K is equal to the largest population number within the given time span.

\- Be sure to choose the function inside of `sapply()` intentionally, either the exponential or logistic equation from the lab handout.

```{r}

# Set the appropriate t
t2 <- 0:50

# Use sapply() to model population sizes (logistic growth)
Nt2 <- sapply(t2, function(tt) {
  (K_8 * N0_8 * exp(r_8 * tt)) / (K_8 + N0_8 * (exp(r_8 * tt) - 1))
})

# Check when (if ever) it exceeds 111,537
t2[which(Nt2 > 111537)[1]]

```

Plot your results like we did in lab:

```{r}

# Create dataframe
model_df2 <- data.frame(
  Day = t2,
  Population = Nt2
)

# Plot
ggplot(model_df2, aes(x = Day, y = Population)) +
  geom_line()

```

### Q: What does this plot imply about the population growth of tribbles on the ship?

```{=plaintext}
The plot shows that the tribble population grows rapidly at first and then slows and levels off/plateaus near a carrying capacity of ~4,200 individuals.
```
### Q: Does the shape of this model match with your plot of the real data above? Do you think it is an accurate model of our system?

```{=plaintext}
Yes, the shape matches the real data because both show fast early growth followed by a slowdown and leveling off. This suggests the logistic model is a reasonable approximation of the system over this time period.
```

------------------------------------------------------------------------

# Exercise 3:

### **Step 1: Visualizing Real Data**

Now plot all time points from the dataset and answer the questions below based on this plot. Use the function `geom_step()` to plot the data.

```{r}

# Create new dataframe without filtering
tribbles_all <- tribbles_clean

# Plot
ggplot(tribbles_all, aes(x = Days, y = Count)) +
  geom_step()

```

### Q: What general trend do you observe in the growth of the tribble population over this period? Does the population appear to be increasing, decreasing, or remaining stable?

```{=plaintext}
The population rapidly increases to begfin and then fluctuates overtime around a pretty stable range rather than continuing to increase indefinitely.
```
### Q: Does population growth appear to be discrete or continuous? Why?

```{=plaintext}
The growth is discrete because the population is recorded at daily time steps and changes in stepwise jumps between days.
```
### Q: Does population growth appear to be density-independent? Why or why not? Which equation, if any, do you think might best fit the trend?

```{=plaintext}
The growth appears dependent of density because the population does not grow without limit and instead fluctuates around a typical range. A logistic growth model with environmental variation would best fit this pattern.
```
### Q: If you think it may be a density-dependent trend, what would you estimate is the carrying capacity of the tribble population?

```{=plaintext}
The carrying capacity appears to be roughly around 4,000 - 5,000 tribbles based on where the population tends to stabilize.
```
### Q: What are some biological, ecological, or stoichastic explanations that could explain the observed trend?

```{=plaintext}
This trend could be explained by limited resources, crowding, disease, waste buildup, or random environmental fluctuations affecting survival and reproduction.
```
### Q: What might be some expected consequences of this trend for the tribble population for the people living on the ship?

```{=plaintext}
The population will likely remain high and variable, causing ongoing issues with overcrowding, resource use, and population management for the ship’s crew.
```

------------------------------------------------------------------------

#### Opinion: what was the most useful and least useful aspect of this lab assignment? Why is that the case for you?

```{=plaintext}
The most useful part of this lab was modeling population growth with exponential and logistic equations because it helped connect real data to theoretical models. The least useful part was repeatedly plotting similar graphs, since those steps were somewhat redundant once the pattern was clear.
```
# References

#### What outside sources did you use to help you complete this work (including books, forums, LLMs, etc.)? Describe how they were used:

```{=plaintext}
I used the Zoom provided by Charles, when I got stuck somewhere I sought out videos on Youtube, if the videos did not help I asked ChatGPT what certain things meant. 
```
